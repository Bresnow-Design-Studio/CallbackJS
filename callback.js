// Generated by CoffeeScript 1.7.1
(function() {
  var Callback, custom;

  custom = {};

  Callback = (function() {
    function Callback(callback) {
      if (!callback) {
        return void 0;
      }
      if (callback.constructor === String) {
        return console.log("Return a custom event");
      }
      if (callback.constructor !== Function) {
        throw new Error("Not a function, bro");
      }
      this.callback = callback;
      this.fired = [];
      this.cancelled = false;
      this.pass = [];
      this["this"] = null;
      this.conditional = null;
      this.error = null;
    }

    Callback.prototype.config = function(vars) {
      var constructor, property;
      if (typeof vars !== 'object') {
        throw new Error("You didn't give an object.");
      }
      for (property in vars) {
        constructor = vars[property].constructor;
        switch (property) {
          case "fired":
            return false;
          case "callback":
            if (constructor !== Function) {
              return false;
            }
            break;
          case "conditional":
            if (constructor !== Function) {
              return false;
            }
            break;
          case "error":
            if (constructor !== Function) {
              return false;
            }
            break;
          case "cancelled":
            if (constructor !== Boolean) {
              return false;
            }
            break;
          case "pass":
            if (constructor !== Array) {
              return false;
            }
        }
        if (this.hasOwnProperty(property)) {
          this[property] = vars[property];
        }
      }
      return this;
    };

    Callback.prototype.cancel = function(arg) {
      if (arg == null) {
        arg = false;
      }
      if (arg === false) {
        this.cancelled = true;
      }
      return this;
    };

    Callback.prototype["catch"] = function(callback) {
      if (!callback) {
        return;
      }
      this.error = callback;
      return this;
    };

    Callback.prototype.when = function(target, event) {
      if (!target) {
        return;
      }
      switch (target.constructor) {
        case String:
          if (!custom[target]) {
            custom[target] = new Array();
          }
          custom[target].push(this);
          break;
        case Object:
          target.addEventListener(event, (function(_this) {
            return function(event) {
              return _this.invoke(event);
            };
          })(this));
      }
      return this;
    };

    Callback.prototype["if"] = function(conditional) {
      if (typeof conditional !== 'function') {
        return false;
      }
      this.conditional = conditional;
      return this;
    };

    Callback.prototype.invoke = function(args) {
      var condition, error;
      if (this.cancelled) {
        return false;
      }
      if (this.conditional) {
        condition = this.conditional();
        if (!condition) {
          return condition;
        }
      }
      try {
        this.callback(args);
        this.fired.push(new Date());
      } catch (_error) {
        error = _error;
        if (typeof this.error === "function") {
          this.error(error);
        }
      }
      return this;
    };

    return Callback;

  })();

  Callback.fire = function(event) {
    var callback, _i, _len, _ref;
    if (typeof event !== 'string') {
      return;
    }
    if (!custom[event]) {
      return;
    }
    _ref = custom[event];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      callback = _ref[_i];
      try {
        callback.invoke();
      } catch (_error) {}
    }
    return custom[event];
  };

  this.Callback = Callback;

}).call(this);
